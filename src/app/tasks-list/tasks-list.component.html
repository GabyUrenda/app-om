<div class="container">
    <!-- Header -->
    <h2>{{title}}</h2>

    <!-- Add section -->
    <div class="section_add">
        <label>New Section</label>
        <div>
            <form #sectionForm="ngForm" (ngSubmit)="onAddSection(sectionForm)">
                <div class="row">
                    <input id="newSection" name="newSection" type="text" placeholder="Here is the section name" required autocomplete="off"
                        [(ngModel)]="newSection"
                        [class.field_error]="sectionForm.submitted && sectionForm.invalid" 
                    />

                    <button class="primary">Add</button>
                </div>
                
                <!-- Message error -->
                <div class="row error_fields" *ngIf="sectionForm.submitted && sectionForm.invalid">
                    <label class="alert_color">You left empty fields</label>
                </div>
            </form>
        </div>
    </div>

    <!-- container -->
    <div class="shadow">
        <!-- Section -->
        <div class="column section_container" *ngIf="sectionList.length > 0">

            <div *ngFor="let section of sectionList">

                <div class="row section_title">
                    <div class="">
                        <h3>{{ section.name }}</h3>
                    </div>

                    <!-- Tasks status-->
                    <div>
                        <b>Tasks: </b>
                        <label class="alert_color margin-right-10">To begin {{ getTaskCount(section, 0) }} </label>
                        <label class="warning_color margin-right-10">In progress {{ getTaskCount(section, 1) }}</label>
                        <label class="success_color">Completed {{ getTaskCount(section,2) }}</label> 
                    </div>

                    <!-- Actions buttons -->
                    <div>
                        <!-- Add -->
                        <button (click)="onShowToAddTask(section)" class="icon margin-right-10" title="Add">
                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plus"
                                class="svg-inline--fa fa-plus fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 448 512">
                                <path fill="currentColor"
                                    d="M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z">
                                </path>
                            </svg>
                        </button>

                        <!-- Delete -->
                        <button (click)="onDeleteSection(section)" class="icon delete margin-right-10" title="Delete">
                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="minus"
                                class="svg-inline--fa fa-minus fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 448 512">
                                <path fill="currentColor"
                                    d="M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z">
                                </path>
                            </svg>
                        </button>

                        <button [class]="section.tasks.length > 0 ? 'icon' : 'icon grey'" title="Show tasks"
                            (click)="onShowTasks(section)">
                            <svg *ngIf="!section.show" aria-hidden="true" focusable="false" data-prefix="fas"
                                data-icon="chevron-down" class="svg-inline--fa fa-chevron-down fa-w-14" role="img"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                <path fill="currentColor"
                                    d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z">
                                </path>
                            </svg>

                            <svg *ngIf="section.show" aria-hidden="true" focusable="false" data-prefix="fas"
                                data-icon="chevron-up" class="svg-inline--fa fa-chevron-up fa-w-14" role="img"
                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                <path fill="currentColor"
                                    d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z">
                                </path>
                            </svg>
                        </button>

                    </div>
                </div>

                <!-- Tasks -->
                <div *ngIf="section.tasks.length > 0 && section.show" class="tasks_container">
                    <!-- Header -->
                    <div class="row header">
                        <div class="tasks_column">
                            {{ taskHeaders.name }}
                        </div>
                        <div class="tasks_column">

                            {{ taskHeaders.description }}
                        </div>
                        <div class="tasks_column">

                            {{ taskHeaders.assignedTo }}
                        </div>
                        <div class="tasks_column">

                            {{ taskHeaders.creationDate }}
                        </div>
                        <div class="tasks_column">

                            {{ taskHeaders.dueDate }}
                        </div>
                        <div class="tasks_column">
                            {{ taskHeaders.status }}
                        </div>
                        <div class="task_column_icon">
                        </div>
                    </div>

                    <!-- Body -->
                    <div class="row body">
                        <!-- tasks -->
                        <div *ngFor="let task of section.tasks" class="row_task_list">
                            <!-- Show task information -->
                            <div *ngIf="task.id" class="row">
                                <!-- Columns -->
                                <div class="tasks_column">{{ task.name }}</div>
                                <div class="tasks_column">{{ task.description }}</div>
                                <div class="tasks_column">{{ task.assignedTo }}</div>
                                <div class="tasks_column">{{ task.creationDate }}</div>
                                <div class="tasks_column">{{ task.dueDate }}</div>

                                <!-- Estatus -->
                                <form #statusForm="ngForm" class="tasks_column">
                                    <div class="tasks_column form-group">
                                        <select [(ngModel)]="task.status" [id]="task.name + _ + task.id"
                                            [name]="task.name + _ + task.id">
                                            <option *ngFor="let option of status" [value]="option.id"
                                                [text]="option.name" [selected]="option.id === task.status">
                                            </option>
                                        </select>

                                    </div>
                                </form>

                                <!-- Delete button -->
                                <div class="task_column_icon">
                                    <button (click)="onDeleteTask(task, section)" class="icon delete">
                                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="minus"
                                            class="svg-inline--fa fa-minus fa-w-14" role="img"
                                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                            <path fill="currentColor"
                                                d="M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z">
                                            </path>
                                        </svg>
                                    </button>
                                </div>

                            </div>

                            <!-- Show form to save new task-->
                            <form #newTaskForm="ngForm" (ngSubmit)="onAddTask(newTaskForm , section)" class="row">
                                <div *ngIf="!task.id" class="row">
                                    <!-- Inputs -->
                                    <div class="tasks_column">
                                        <input id="title" name="title" type="text" placeholder="Title" required autocomplete="off"
                                            [(ngModel)]="task.name"
                                            [class.field_error]="newTaskForm.submitted && newTaskForm.invalid" 
                                        />
                                    </div>

                                    <div class="tasks_column">
                                        <textarea  id="description" name="description" type="text" placeholder="Description" required autocomplete="off"
                                            [(ngModel)]="task.description"
                                            [class.field_error]="newTaskForm.submitted && newTaskForm.invalid" 
                                        >
                                        </textarea>
                                    </div>

                                    <div class="tasks_column">
                                        <select [(ngModel)]="task.assignedTo" id="assignedTo" name="assignedTo" required>
                                            <option *ngFor="let option of teamMembers" [value]="option.name"
                                                [text]="option.name">
                                            </option>
                                        </select>
                                    </div>

                                    <div class="tasks_column">
                                        {{ task.creationDate }}
                                    </div>

                                    <div class="tasks_column">
                                        <input id="dueDate" name="dueDate" type="date" placeholder="Due date" required autocomplete="off" 
                                            [min]="today"
                                            [(ngModel)]="task.dueDate"
                                            [class.field_error]="newTaskForm.submitted && newTaskForm.invalid" 
                                        />
                                    </div>

                                    <!-- Estatus -->
                                    <div class="tasks_column form-group">
                                        <select required
                                            [(ngModel)]="task.status" 
                                            [id]="task.name + _ + task.id"
                                            [name]="task.name + _ + task.id">
                                            <option 
                                                *ngFor="let option of status" 
                                                [value]="option.id"
                                                [text]="option.name" 
                                                [selected]="option.id === task.status"
                                            >
                                            </option>
                                        </select>

                                    </div>

                                    <!-- Save button -->
                                    <div class="task_column_icon">
                                        <!-- Save button -->
                                        <button class="icon success">
                                            <svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="save"
                                                class="svg-inline--fa fa-save fa-w-14" role="img"
                                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                                <path fill="currentColor"
                                                    d="M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM272 80v80H144V80h128zm122 352H54a6 6 0 0 1-6-6V86a6 6 0 0 1 6-6h42v104c0 13.255 10.745 24 24 24h176c13.255 0 24-10.745 24-24V83.882l78.243 78.243a6 6 0 0 1 1.757 4.243V426a6 6 0 0 1-6 6zM224 232c-48.523 0-88 39.477-88 88s39.477 88 88 88 88-39.477 88-88-39.477-88-88-88zm0 128c-22.056 0-40-17.944-40-40s17.944-40 40-40 40 17.944 40 40-17.944 40-40 40z">
                                                </path>
                                            </svg>
                                        </button>

                                        <!-- Delete button -->
                                        <button (click)="onDeleteTask(task, section)" class="icon delete">
                                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="minus"
                                                class="svg-inline--fa fa-minus fa-w-14" role="img"
                                                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                                                <path fill="currentColor"
                                                    d="M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z">
                                                </path>
                                            </svg>
                                        </button>
                                    
                                    </div>

                                </div>

                                <!-- Message error -->
                                <div class="row error_fields" *ngIf="newTaskForm.submitted && newTaskForm.invalid">
                                    <label class="alert_color">You left empty fields</label>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- Tasks-->
                </div>

            </div>

        </div>

        <!-- If there are no sections -->
        <div class="not-records" *ngIf="sectionList.length === 0">
            <h3>It seems you have no sections, add one to start!</h3>
        </div>

    </div>

</div>